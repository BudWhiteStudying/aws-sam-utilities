AWSTemplateFormatVersion: '2010-09-09'
Description: 'shift_manager_aws

  Sample SAM Template for shift_manager_aws

  '
Globals:
  Function:
    Layers:
      - !Ref SharedUtilitiesLayer
    Timeout: 3


Outputs:
  NamedShiftApi:
    Description: API Gateway endpoint URL for the Prod stage
    Value: !Sub 'https://${ServerlessRestApi}.execute-api.${AWS::Region}.amazonaws.com/Prod/named-shift/'
  CreateNotificationRuleFunction:
    Description: Lambda Function ARN
    Value: !GetAtt 'CreateNotificationRuleFunction.Arn'
  CreateNotificationRuleFunctionIamRole:
    Description: Implicit IAM Role created for the Lambda Function
    Value: !GetAtt 'CreateNotificationRuleFunctionRole.Arn'
  CreateOperatorFunction:
    Description: Lambda Function ARN
    Value: !GetAtt 'CreateOperatorFunction.Arn'
  CreateOperatorFunctionIamRole:
    Description: Implicit IAM Role created for the Lambda Function
    Value: !GetAtt 'CreateOperatorFunctionRole.Arn'
  CreateShiftFunction:
    Description: Lambda Function ARN
    Value: !GetAtt 'CreateShiftFunction.Arn'
  CreateShiftFunctionIamRole:
    Description: Implicit IAM Role created for the Lambda Function
    Value: !GetAtt 'CreateShiftFunctionRole.Arn'
  DeleteNotificationRuleFunction:
    Description: Lambda Function ARN
    Value: !GetAtt 'DeleteNotificationRuleFunction.Arn'
  DeleteNotificationRuleFunctionIamRole:
    Description: Implicit IAM Role created for the Lambda Function
    Value: !GetAtt 'DeleteNotificationRuleFunctionRole.Arn'
  DeleteOperatorFunction:
    Description: Lambda Function ARN
    Value: !GetAtt 'DeleteOperatorFunction.Arn'
  DeleteOperatorFunctionIamRole:
    Description: Implicit IAM Role created for the Lambda Function
    Value: !GetAtt 'DeleteOperatorFunctionRole.Arn'
  DeleteShiftFunction:
    Description: Lambda Function ARN
    Value: !GetAtt 'DeleteShiftFunction.Arn'
  DeleteShiftFunctionIamRole:
    Description: Implicit IAM Role created for the Lambda Function
    Value: !GetAtt 'DeleteShiftFunctionRole.Arn'
  GetNamedShiftFunction:
    Description: Lambda Function ARN
    Value: !GetAtt 'GetNamedShiftFunction.Arn'
  GetNamedShiftFunctionIamRole:
    Description: Implicit IAM Role created for the Lambda Function
    Value: !GetAtt 'GetNamedShiftFunctionRole.Arn'
  GetNotificationRuleFunction:
    Description: Lambda Function ARN
    Value: !GetAtt 'GetNotificationRuleFunction.Arn'
  GetNotificationRuleFunctionIamRole:
    Description: Implicit IAM Role created for the Lambda Function
    Value: !GetAtt 'GetNotificationRuleFunctionRole.Arn'
  GetOperatorFunction:
    Description: Lambda Function ARN
    Value: !GetAtt 'GetOperatorFunction.Arn'
  GetOperatorFunctionIamRole:
    Description: Implicit IAM Role created for the Lambda Function
    Value: !GetAtt 'GetOperatorFunctionRole.Arn'
  GetOperatorsFunction:
    Description: Lambda Function ARN
    Value: !GetAtt 'GetOperatorsFunction.Arn'
  GetOperatorsFunctionIamRole:
    Description: Implicit IAM Role created for the Lambda Function
    Value: !GetAtt 'GetOperatorsFunctionRole.Arn'
  GetShiftFunction:
    Description: Lambda Function ARN
    Value: !GetAtt 'GetShiftFunction.Arn'
  GetShiftFunctionIamRole:
    Description: Implicit IAM Role created for the Lambda Function
    Value: !GetAtt 'GetShiftFunctionRole.Arn'
  NotificationRuleApi:
    Description: API Gateway endpoint URL for the Prod stage
    Value: !Sub 'https://${ServerlessRestApi}.execute-api.${AWS::Region}.amazonaws.com/Prod/notification-rule/'
  OperatorApi:
    Description: API Gateway endpoint URL for the Prod stage
    Value: !Sub 'https://${ServerlessRestApi}.execute-api.${AWS::Region}.amazonaws.com/Prod/operator/'
  OperatorsApi:
    Description: API Gateway endpoint URL for the Prod stage
    Value: !Sub 'https://${ServerlessRestApi}.execute-api.${AWS::Region}.amazonaws.com/Prod/operators/'
  ShiftApi:
    Description: API Gateway endpoint URL for the Prod stage
    Value: !Sub 'https://${ServerlessRestApi}.execute-api.${AWS::Region}.amazonaws.com/Prod/shift/'
  ShiftNotificationApi:
    Description: API Gateway endpoint URL for the Prod stage
    Value: !Sub 'https://${ServerlessRestApi}.execute-api.${AWS::Region}.amazonaws.com/Prod/shift-notification/'
  TriggerShiftNotificationFunction:
    Description: Lambda Function ARN
    Value: !GetAtt 'TriggerShiftNotificationFunction.Arn'
  TriggerShiftNotificationFunctionIamRole:
    Description: Implicit IAM Role created for the Lambda Function
    Value: !GetAtt 'TriggerShiftNotificationFunctionRole.Arn'
  UpdateNotificationRuleFunction:
    Description: Lambda Function ARN
    Value: !GetAtt 'UpdateNotificationRuleFunction.Arn'
  UpdateNotificationRuleFunctionIamRole:
    Description: Implicit IAM Role created for the Lambda Function
    Value: !GetAtt 'UpdateNotificationRuleFunctionRole.Arn'
  UpdateOperatorFunction:
    Description: Lambda Function ARN
    Value: !GetAtt 'UpdateOperatorFunction.Arn'
  UpdateOperatorFunctionIamRole:
    Description: Implicit IAM Role created for the Lambda Function
    Value: !GetAtt 'UpdateOperatorFunctionRole.Arn'
  UpdateShiftFunction:
    Description: Lambda Function ARN
    Value: !GetAtt 'UpdateShiftFunction.Arn'
  UpdateShiftFunctionIamRole:
    Description: Implicit IAM Role created for the Lambda Function
    Value: !GetAtt 'UpdateShiftFunctionRole.Arn'
Resources:
  SharedUtilitiesLayer:
    Type: AWS::Serverless::LayerVersion
    Properties:
          LayerName: shared-utilities
          Description: Shared utilities for the shift_manager app
          ContentUri: lambda_layers/shared_utils
          CompatibleRuntimes:
            - python3.9
          LicenseInfo: 'MIT'
          RetentionPolicy: Retain
  CreateNotificationRuleFunction:
    Properties:
      Architectures:
      - x86_64
      CodeUri: create_notification_rule/
      Events:
        CreateNotificationRule:
          Properties:
            Method: post
            Path: /notification-rule
          Type: Api
      Handler: app.lambda_handler
      Runtime: python3.9
    Type: AWS::Serverless::Function
  CreateOperatorFunction:
    Properties:
      Architectures:
      - x86_64
      CodeUri: create_operator/
      Events:
        CreateOperator:
          Properties:
            Method: post
            Path: /operator
          Type: Api
      Handler: app.lambda_handler
      Runtime: python3.9
    Type: AWS::Serverless::Function
  CreateShiftFunction:
    Properties:
      Architectures:
      - x86_64
      CodeUri: create_shift/
      Events:
        CreateShift:
          Properties:
            Method: post
            Path: /shift
          Type: Api
      Handler: app.lambda_handler
      Runtime: python3.9
    Type: AWS::Serverless::Function
  DeleteNotificationRuleFunction:
    Properties:
      Architectures:
      - x86_64
      CodeUri: delete_notification_rule/
      Events:
        DeleteNotificationRule:
          Properties:
            Method: delete
            Path: /notification-rule
          Type: Api
      Handler: app.lambda_handler
      Runtime: python3.9
    Type: AWS::Serverless::Function
  DeleteOperatorFunction:
    Properties:
      Architectures:
      - x86_64
      CodeUri: delete_operator/
      Events:
        DeleteOperator:
          Properties:
            Method: delete
            Path: /operator
          Type: Api
      Handler: app.lambda_handler
      Runtime: python3.9
    Type: AWS::Serverless::Function
  DeleteShiftFunction:
    Properties:
      Architectures:
      - x86_64
      CodeUri: delete_shift/
      Events:
        DeleteShift:
          Properties:
            Method: delete
            Path: /shift
          Type: Api
      Handler: app.lambda_handler
      Runtime: python3.9
    Type: AWS::Serverless::Function
  GetNamedShiftFunction:
    Properties:
      Architectures:
      - x86_64
      CodeUri: get_named_shift/
      Events:
        GetNamedShift:
          Properties:
            Method: get
            Path: /named-shift
          Type: Api
      Handler: app.lambda_handler
      Runtime: python3.9
    Type: AWS::Serverless::Function
  GetNotificationRuleFunction:
    Properties:
      Architectures:
      - x86_64
      CodeUri: get_notification_rule/
      Events:
        GetNotificationRule:
          Properties:
            Method: get
            Path: /notification-rule
          Type: Api
      Handler: app.lambda_handler
      Runtime: python3.9
    Type: AWS::Serverless::Function
  GetOperatorFunction:
    Properties:
      Architectures:
      - x86_64
      CodeUri: get_operator/
      Events:
        GetOperator:
          Properties:
            Method: get
            Path: /operator
          Type: Api
      Handler: app.lambda_handler
      Runtime: python3.9
    Type: AWS::Serverless::Function
  GetOperatorsFunction:
    Properties:
      Architectures:
      - x86_64
      CodeUri: get_operators/
      Events:
        GetOperators:
          Properties:
            Method: get
            Path: /operators
          Type: Api
      Handler: app.lambda_handler
      Runtime: python3.9
    Type: AWS::Serverless::Function
  GetShiftFunction:
    Properties:
      Architectures:
      - x86_64
      CodeUri: get_shift/
      Events:
        GetShift:
          Properties:
            Method: get
            Path: /shift
          Type: Api
      Handler: app.lambda_handler
      Runtime: python3.9
    Type: AWS::Serverless::Function
  TriggerShiftNotificationFunction:
    Properties:
      Architectures:
      - x86_64
      CodeUri: trigger_shift_notification/
      Events:
        TriggerShiftNotification:
          Properties:
            Method: get
            Path: /shift-notification
          Type: Api
      Handler: app.lambda_handler
      Runtime: python3.9
    Type: AWS::Serverless::Function
  UpdateNotificationRuleFunction:
    Properties:
      Architectures:
      - x86_64
      CodeUri: update_notification_rule/
      Events:
        UpdateNotificationRule:
          Properties:
            Method: put
            Path: /notification-rule
          Type: Api
      Handler: app.lambda_handler
      Runtime: python3.9
    Type: AWS::Serverless::Function
  UpdateOperatorFunction:
    Properties:
      Architectures:
      - x86_64
      CodeUri: update_operator/
      Events:
        UpdateOperator:
          Properties:
            Method: put
            Path: /operator
          Type: Api
      Handler: app.lambda_handler
      Runtime: python3.9
    Type: AWS::Serverless::Function
  UpdateShiftFunction:
    Properties:
      Architectures:
      - x86_64
      CodeUri: update_shift/
      Events:
        UpdateShift:
          Properties:
            Method: put
            Path: /shift
          Type: Api
      Handler: app.lambda_handler
      Runtime: python3.9
    Type: AWS::Serverless::Function
Transform: AWS::Serverless-2016-10-31
